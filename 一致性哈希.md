设计目标是为了解决因特网中的热点问题。

判定哈希算法好坏的四个方面：

1. 平衡性。哈希结果尽可能分布到所有缓冲
2. 单调性。增加新的缓冲区，哈希的结果应保证已分配内容被映射到原有缓冲区或新的缓冲区，而不应被映射到其他旧的缓冲区。
3. 分散性。
4. 负载



## 一致性哈希是如何设计的

在采用一致性哈希算法的分布式集群中将新的机器加入，其原理是通过hash算法将机器也映射到环中，然后以顺时针方向将对象存储到离自己最近的机器节点。

步骤如下：

1. 环形hash空间
2. 把数据通过hash算法处理后映射到环上
3. 将机器通过hash算法映射到环上
4. 数据对象按顺时针方向迁移到最近的机器



**进行机器添加或删除时，对数据迁移的影响**

如果某个节点出现故障被删除，按照顺时针迁移的方法，将故障节点上的对象迁移到最近的下个节点。只有故障节点上的对象发生变化，其它的对象没有任何改动。

如果向集群中添加一个新节点，通过哈希算法计算机器的哈希值，并映射到环中。将新节点和新节点之前节点之间的数据迁移到新节点，其他对象保持原有的存储位置。

通过对节点添加和删除过程的分析，一致性哈希算法保证了单调性，并使数据迁移量达到最小。这样的算法对分布式集群来说是非常合适的，避免了大量数据迁移，减小了服务器的压力。

**满足平衡性要求**

在一致性哈希算法中，为了尽可能地满足平衡性，引入了虚拟节点。

![哈希-虚拟节点](pictures/哈希-虚拟节点.png)